{
  "openapi": "3.0.1",
  "info": {
    "title": "Parque Temático Virtual API",
    "description": "API para gestionar todas las operaciones del parque temático.",
    "version": "v1"
  },
  "paths": {
    "/attractions": {
      "get": {
        "tags": [
          "Attraction"
        ],
        "summary": "Obtiene una lista de todas las atracciones.",
        "responses": {
          "200": {
            "description": "Devuelve la lista de todas atracciones.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AttractionResponse"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AttractionResponse"
                  }
                }
              },
              "text/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AttractionResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Administrador."
          }
        }
      },
      "post": {
        "tags": [
          "Attraction"
        ],
        "summary": "Crea una nueva atracción.",
        "requestBody": {
          "description": "Datos de la nueva atracción.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAttractionRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAttractionRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAttractionRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/IdResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdResponse"
                }
              }
            }
          },
          "201": {
            "description": "Atracción creada exitosamente."
          },
          "400": {
            "description": "Si los datos proporcionados son inválidos."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Administrador."
          }
        }
      }
    },
    "/attractions/{id}": {
      "get": {
        "tags": [
          "Attraction"
        ],
        "summary": "Obtiene una atracción específica por su ID.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) de la atracción.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Created",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/AttractionResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttractionResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttractionResponse"
                }
              }
            }
          },
          "404": {
            "description": "Si la atracción no existe.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "401": {
            "description": "Si el usuario no está autenticado.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Administrador.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Devuelve la atracción encontrada."
          }
        }
      },
      "delete": {
        "tags": [
          "Attraction"
        ],
        "summary": "Elimina una atracción por su ID.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) de la atracción a eliminar.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success"
          },
          "204": {
            "description": "Atracción eliminada exitosamente."
          },
          "404": {
            "description": "Si la atracción no existe."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Administrador."
          }
        }
      },
      "put": {
        "tags": [
          "Attraction"
        ],
        "summary": "Modifica una atracción existente.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) de la atracción a modificar.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "Los nuevos datos para la atracción.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ModifyAttractionParamsRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/ModifyAttractionParamsRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/ModifyAttractionParamsRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Devuelve la atracción actualizada.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/AttractionResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttractionResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttractionResponse"
                }
              }
            }
          },
          "404": {
            "description": "Si la atracción no existe."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Administrador."
          }
        }
      }
    },
    "/attractions/{id}/incidents": {
      "put": {
        "tags": [
          "Attraction"
        ],
        "summary": "Agrega un incidente a una atraccion.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) de la atracción destino.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "El incidente a agregar.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IncidentRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/IncidentRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/IncidentRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Incidente agregado existosamente."
          },
          "404": {
            "description": "Si la atracción no existe."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Administrador."
          }
        }
      },
      "delete": {
        "tags": [
          "Attraction"
        ],
        "summary": "Elimina un incidente de la atraccion.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) de la atraccion destino.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "El incidente a eliminar.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IncidentRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/IncidentRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/IncidentRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success"
          },
          "204": {
            "description": "Incidente eliminado exitosamente."
          },
          "404": {
            "description": "Si la atracción no existe."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Admin."
          }
        }
      }
    },
    "/attractions/{id}/visitors": {
      "get": {
        "tags": [
          "AttractionControl"
        ],
        "summary": "Obtiene una lista de los IDs de los visitantes actualmente dentro de una atracción.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) de la atracción.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Devuelve la lista de todos los visitantes.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/IdResponse"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/IdResponse"
                  }
                }
              },
              "text/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/IdResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Operador."
          },
          "404": {
            "description": "Si no se encuentra un atraccion con ese ID."
          }
        }
      },
      "post": {
        "tags": [
          "AttractionControl"
        ],
        "summary": "Registra la entrada de un visitante a una atracción.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) de la atracción.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "byTicket",
            "in": "query",
            "description": "Booleano que permite elegir entre entrar usando el qr del ticket (true) o usando el id del usuario (false).",
            "schema": {
              "type": "boolean"
            }
          }
        ],
        "requestBody": {
          "description": "El QR (GUID) del ticket o el ID (GUID) del visitante a entrar.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IdRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/IdRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/IdRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Entrada registrada exitosamente."
          },
          "400": {
            "description": "Si el visitante no cumple los requisitos (ej. edad)."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Operador."
          },
          "404": {
            "description": "Si la atracción, el ticket o el visitante no existen."
          },
          "409": {
            "description": "Si la atraccion tiene incidentes o esta llena."
          }
        }
      },
      "delete": {
        "tags": [
          "AttractionControl"
        ],
        "summary": "Registra la salida de un visitante de una atracción con su id.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) de la atracción.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "El ID (GUID) del visitante.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IdRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/IdRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/IdRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Salida registrada exitosamente."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Operador."
          },
          "404": {
            "description": "Si no se encuentra un atraccion con ese ID."
          }
        }
      }
    },
    "/attractions/{id}/reports": {
      "get": {
        "tags": [
          "AttractionControl"
        ],
        "summary": "Genera un reporte del número de usos de la atracción entre dos fechas.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) de la atracción.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "El rango de fechas (Desde/Hasta) para el reporte.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DateSpanRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/DateSpanRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/DateSpanRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/NumberUsesResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NumberUsesResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/NumberUsesResponse"
                }
              }
            }
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Operador."
          },
          "404": {
            "description": "Si no se encuentra un atraccion con ese ID."
          }
        }
      }
    },
    "/auth/login": {
      "post": {
        "tags": [
          "Authorization"
        ],
        "summary": "Autentica a un usuario y devuelve un JWT.",
        "requestBody": {
          "description": "Credenciales del usuario (email y contraseña).",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Devuelve el token JWT.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              }
            }
          },
          "400": {
            "description": "Si el formato es inválido."
          },
          "403": {
            "description": "Si las credenciales son incorrectas."
          }
        }
      }
    },
    "/ranking/strategies": {
      "get": {
        "tags": [
          "Ranking"
        ],
        "summary": "Obtiene las estrategias de puntuación disponibles o solo la que está activa.",
        "parameters": [
          {
            "name": "getActive",
            "in": "query",
            "description": "Si es 'true', devuelve solo la estrategia activa. De lo contrario, devuelve todas.",
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Devuelve la(s) estrategia(s) solicitada(s).",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/GetStrategyResponse"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/GetStrategyResponse"
                  }
                }
              },
              "text/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/GetStrategyResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Admin."
          }
        }
      }
    },
    "/ranking": {
      "post": {
        "tags": [
          "Ranking"
        ],
        "summary": "Establece la estrategia de puntuación activa para el parque.",
        "requestBody": {
          "description": "El tipo de estrategia a activar.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetActiveStrategyRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/SetActiveStrategyRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/SetActiveStrategyRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "La estrategia se estableció correctamente.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/GetStrategyResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetStrategyResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetStrategyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Si el tipo de estrategia es inválido."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Admin."
          }
        }
      },
      "get": {
        "tags": [
          "Ranking"
        ],
        "summary": "Obtiene la tabla de clasificación diaria de los visitantes con más puntos.",
        "responses": {
          "200": {
            "description": "Devuelve el ranking diario.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/UserRankingResponse"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/UserRankingResponse"
                  }
                }
              },
              "text/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/UserRankingResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Admin."
          }
        }
      }
    },
    "/specialevents/{id}": {
      "get": {
        "tags": [
          "SpecialEvent"
        ],
        "summary": "Obtiene un evento especial específico por su ID.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) del evento.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Devuelve el evento encontrado.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/GetEventResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetEventResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetEventResponse"
                }
              }
            }
          },
          "404": {
            "description": "Si el evento no existe."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Admin."
          }
        }
      },
      "delete": {
        "tags": [
          "SpecialEvent"
        ],
        "summary": "Elimina un evento especial por su ID.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) del evento a eliminar.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success"
          },
          "204": {
            "description": "Evento eliminado exitosamente."
          },
          "404": {
            "description": "Si el evento no existe."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Admin."
          }
        }
      }
    },
    "/specialevents": {
      "get": {
        "tags": [
          "SpecialEvent"
        ],
        "summary": "Obtiene una lista de todos los eventos especiales.",
        "responses": {
          "200": {
            "description": "Devuelve la lista de eventos.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/GetEventResponse"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/GetEventResponse"
                  }
                }
              },
              "text/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/GetEventResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Admin."
          }
        }
      },
      "post": {
        "tags": [
          "SpecialEvent"
        ],
        "summary": "Crea un nuevo evento especial.",
        "requestBody": {
          "description": "Datos para el nuevo evento.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSpecialEventRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSpecialEventRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSpecialEventRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Evento creado exitosamente.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/IdResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdResponse"
                }
              }
            }
          },
          "400": {
            "description": "Si los datos proporcionados son inválidos."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Admin."
          }
        }
      }
    },
    "/specialevents/{id}/attractions": {
      "post": {
        "tags": [
          "SpecialEvent"
        ],
        "summary": "Asigna una atracción a un evento especial.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) del evento.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "El ID (GUID) de la atracción a añadir.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IdRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/IdRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/IdRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Atracción añadida al evento correctamente."
          },
          "404": {
            "description": "Si el evento o la atracción no existen."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Admin."
          }
        }
      },
      "delete": {
        "tags": [
          "SpecialEvent"
        ],
        "summary": "Quita una atracción de un evento especial.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) del evento.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "El ID (GUID) de la atracción a quitar.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IdRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/IdRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/IdRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Atracción quitada del evento correctamente."
          },
          "404": {
            "description": "Si el evento o la atracción no existen."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Admin."
          }
        }
      },
      "get": {
        "tags": [
          "SpecialEvent"
        ],
        "summary": "Obtiene la lista de atracciones asociadas a un evento especial.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) del evento.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Devuelve las atracciones del evento.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/AttractionListResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttractionListResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttractionListResponse"
                }
              }
            }
          },
          "404": {
            "description": "Si el evento no existe."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Admin."
          }
        }
      }
    },
    "/time": {
      "get": {
        "tags": [
          "SystemTime"
        ],
        "summary": "Obtiene la fecha y hora actual configurada en el sistema.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/GetTimeResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetTimeResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetTimeResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "SystemTime"
        ],
        "summary": "Establece una nueva fecha y hora para el sistema.",
        "requestBody": {
          "description": "La nueva fecha y hora en formato \"YYYY-MM-DDTHH:MM\".",
          "content": {
            "application/json": {
              "schema": {
                "type": "string"
              }
            },
            "text/json": {
              "schema": {
                "type": "string"
              }
            },
            "application/*+json": {
              "schema": {
                "type": "string"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "La hora del sistema fue actualizada correctamente.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/SetTimeResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SetTimeResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/SetTimeResponse"
                }
              }
            }
          },
          "400": {
            "description": "Si el formato de la fecha es inválido."
          }
        }
      }
    },
    "/tickets": {
      "post": {
        "tags": [
          "Ticket"
        ],
        "summary": "Permite a un visitante comprar un ticket para una fecha o evento especial.",
        "requestBody": {
          "description": "Datos de la compra del ticket, incluyendo ID de usuario y fecha.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BuyTicketRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/BuyTicketRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/BuyTicketRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Ticket comprado y creado exitosamente.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/IdResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdResponse"
                }
              }
            }
          },
          "400": {
            "description": "Si los datos son inválidos o no se puede comprar el ticket (ej. evento lleno)."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Visitante."
          },
          "404": {
            "description": "Si la atracción o el evento no existen."
          }
        }
      }
    },
    "/users/sign-up": {
      "post": {
        "tags": [
          "User"
        ],
        "summary": "Registra un nuevo visitante en el sistema.",
        "requestBody": {
          "description": "Datos del nuevo visitante a registrar.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateVisitorRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateVisitorRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/CreateVisitorRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Usuario visitante creado exitosamente.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/SignupResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SignupResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/SignupResponse"
                }
              }
            }
          },
          "400": {
            "description": "Si los datos son inválidos."
          },
          "409": {
            "description": "Si el email ya existe."
          }
        }
      }
    },
    "/users": {
      "put": {
        "tags": [
          "User"
        ],
        "summary": "Permite a un usuario autenticado modificar su propio perfil.",
        "requestBody": {
          "description": "Datos del perfil a modificar.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ModifyUserRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/ModifyUserRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/ModifyUserRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Retorna el ID del usuario modificado.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/IdResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdResponse"
                }
              }
            }
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "404": {
            "description": "Si el usuario no se encuentra."
          }
        }
      },
      "post": {
        "tags": [
          "User"
        ],
        "summary": "Permite a un administrador crear cualquier tipo de usuario (Admin, Operator, Visitor) (Admin).",
        "requestBody": {
          "description": "Datos del nuevo usuario y sus roles.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AdminCreateUserRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/AdminCreateUserRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/AdminCreateUserRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success"
          },
          "201": {
            "description": "Usuario creado exitosamente por el administrador."
          },
          "400": {
            "description": "Si los datos del usuario estan malformados (visitante con fecha de nacimiento nula o tipo de membresia invalida)."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Administrador."
          },
          "409": {
            "description": "Si ya existe usuario con email."
          }
        }
      },
      "get": {
        "tags": [
          "User"
        ],
        "summary": "Obtiene una lista de todos los usuarios del sistema (Admin).",
        "responses": {
          "200": {
            "description": "Devuelve la lista de todos los usuarios.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/GetUserResponse"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/GetUserResponse"
                  }
                }
              },
              "text/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/GetUserResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Administrador."
          }
        }
      }
    },
    "/users/{id}": {
      "get": {
        "tags": [
          "User"
        ],
        "summary": "Obtiene un usuario específico por su ID (Admin).",
        "operationId": "GetUserById",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "El ID (GUID) del usuario a buscar.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Devuelve los datos del usuario.",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/GetUserResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetUserResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetUserResponse"
                }
              }
            }
          },
          "404": {
            "description": "Si no se encuentra un usuario con ese ID."
          },
          "401": {
            "description": "Si el usuario no está autenticado."
          },
          "403": {
            "description": "Si el usuario no tiene el rol de Administrador."
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AdminCreateUserRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "nullable": true
          },
          "lastName": {
            "type": "string",
            "nullable": true
          },
          "email": {
            "type": "string",
            "nullable": true
          },
          "password": {
            "type": "string",
            "nullable": true
          },
          "isVisitor": {
            "type": "boolean",
            "nullable": true
          },
          "isOperator": {
            "type": "boolean",
            "nullable": true
          },
          "isAdmin": {
            "type": "boolean",
            "nullable": true
          },
          "dateOfBirth": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "membrshipType": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "AttractionListResponse": {
        "type": "object",
        "properties": {
          "attractions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AttractionResponse"
            },
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "AttractionResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string",
            "nullable": true
          },
          "type": {
            "type": "string",
            "nullable": true
          },
          "minAge": {
            "maximum": 4294967295,
            "minimum": 0,
            "type": "integer",
            "format": "int64"
          },
          "capacity": {
            "maximum": 4294967295,
            "minimum": 0,
            "type": "integer",
            "format": "int64"
          },
          "visitorCount": {
            "maximum": 4294967295,
            "minimum": 0,
            "type": "integer",
            "format": "int64"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "incidents": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "BuyTicketRequest": {
        "type": "object",
        "properties": {
          "userId": {
            "type": "string",
            "format": "uuid"
          },
          "ticketDate": {
            "type": "string",
            "format": "date-time"
          },
          "specialEventId": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "CreateAttractionRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "nullable": true
          },
          "type": {
            "type": "string",
            "nullable": true
          },
          "minAge": {
            "maximum": 4294967295,
            "minimum": 0,
            "type": "integer",
            "format": "int64"
          },
          "capacity": {
            "maximum": 4294967295,
            "minimum": 0,
            "type": "integer",
            "format": "int64"
          },
          "description": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "CreateSpecialEventRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "nullable": true
          },
          "additionalCost": {
            "type": "number",
            "format": "double"
          },
          "capacity": {
            "type": "integer",
            "format": "int32"
          },
          "date": {
            "type": "string",
            "format": "date-time"
          }
        },
        "additionalProperties": false
      },
      "CreateVisitorRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "nullable": true
          },
          "lastName": {
            "type": "string",
            "nullable": true
          },
          "email": {
            "type": "string",
            "nullable": true
          },
          "password": {
            "type": "string",
            "nullable": true
          },
          "dateOfBirth": {
            "type": "string",
            "format": "date-time"
          }
        },
        "additionalProperties": false
      },
      "DateSpanRequest": {
        "type": "object",
        "properties": {
          "from": {
            "type": "string",
            "format": "date-time"
          },
          "to": {
            "type": "string",
            "format": "date-time"
          }
        },
        "additionalProperties": false
      },
      "GetEventResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string",
            "nullable": true
          },
          "additionalCost": {
            "type": "number",
            "format": "double"
          },
          "capacity": {
            "type": "integer",
            "format": "int32"
          },
          "date": {
            "type": "string",
            "format": "date-time"
          }
        },
        "additionalProperties": false
      },
      "GetStrategyResponse": {
        "type": "object",
        "properties": {
          "strategy": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "GetTimeResponse": {
        "type": "object",
        "properties": {
          "timeInFormat": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "GetUserResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "nfc": {
            "type": "string",
            "format": "uuid"
          },
          "email": {
            "type": "string",
            "nullable": true
          },
          "firstName": {
            "type": "string",
            "nullable": true
          },
          "lastName": {
            "type": "string",
            "nullable": true
          },
          "isVisitor": {
            "type": "boolean"
          },
          "isOperator": {
            "type": "boolean"
          },
          "isAdmin": {
            "type": "boolean"
          },
          "visitorProfile": {
            "$ref": "#/components/schemas/VisitorProfileResponse"
          }
        },
        "additionalProperties": false
      },
      "IdRequest": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          }
        },
        "additionalProperties": false
      },
      "IdResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          }
        },
        "additionalProperties": false
      },
      "IncidentRequest": {
        "type": "object",
        "properties": {
          "incident": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "LoginRequest": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "nullable": true
          },
          "password": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "ModifyAttractionParamsRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "nullable": true
          },
          "type": {
            "type": "string",
            "nullable": true
          },
          "minAge": {
            "maximum": 4294967295,
            "minimum": 0,
            "type": "integer",
            "format": "int64"
          },
          "capacity": {
            "maximum": 4294967295,
            "minimum": 0,
            "type": "integer",
            "format": "int64"
          },
          "description": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "ModifyUserRequest": {
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string",
            "nullable": true
          },
          "lastName": {
            "type": "string",
            "nullable": true
          },
          "password": {
            "type": "string",
            "nullable": true
          },
          "birthDate": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "NumberUsesResponse": {
        "type": "object",
        "properties": {
          "numberUses": {
            "type": "integer",
            "format": "int32"
          }
        },
        "additionalProperties": false
      },
      "ProblemDetails": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "nullable": true
          },
          "title": {
            "type": "string",
            "nullable": true
          },
          "status": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "detail": {
            "type": "string",
            "nullable": true
          },
          "instance": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": { }
      },
      "SetActiveStrategyRequest": {
        "type": "object",
        "properties": {
          "strategyType": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "SetTimeResponse": {
        "type": "object",
        "properties": {
          "setTime": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "SignupResponse": {
        "type": "object",
        "properties": {
          "isAdmin": {
            "type": "boolean"
          }
        },
        "additionalProperties": false
      },
      "TokenResponse": {
        "type": "object",
        "properties": {
          "token": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "UserRankingResponse": {
        "type": "object",
        "properties": {
          "fristName": {
            "type": "string",
            "nullable": true
          },
          "lastName": {
            "type": "string",
            "nullable": true
          },
          "email": {
            "type": "string",
            "nullable": true
          },
          "points": {
            "type": "integer",
            "format": "int32"
          }
        },
        "additionalProperties": false
      },
      "VisitorProfileResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "birthDate": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "membership": {
            "type": "string",
            "nullable": true
          },
          "currentAttractionId": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          }
        },
        "additionalProperties": false
      }
    }
  }
}